<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>URL管理＆整理くん</title>
<style>
body {
  font-family: sans-serif;
  background: #ffffff;
  margin: 20px;
}

h1 {
  margin-bottom: 10px;
}

input, textarea, button {
  margin: 4px 0;
  padding: 6px;
  width: 100%;
}

button {
  cursor: pointer;
}

.entry {
  border: 1px solid #ccc;
  padding: 10px;
  margin-top: 10px;
}

.small {
  font-size: 12px;
  color: #555;
}
</style>
</head>

<body>

<h1>URL管理＆整理くん</h1>

<h3>追加</h3>
<input id="url" placeholder="URL">
<input id="genre" placeholder="ジャンル（自由入力）">
<textarea id="memo" placeholder="備考"></textarea>
<button onclick="addEntry()">追加</button>

<hr>

<h3>検索</h3>
<input id="searchGenre" placeholder="ジャンルで検索">
<input id="searchDate" type="date">
<button onclick="search()">検索</button>
<button onclick="clearSearch()">検索クリア</button>

<hr>

<div id="list"></div>

<script>
let data = [];

function addEntry() {
  const url = document.getElementById("url").value;
  const genre = document.getElementById("genre").value;
  const memo = document.getElementById("memo").value;
  if (!url) return;

  const now = new Date();
  data.push({
    url,
    genre,
    memo,
    date: now.toISOString().slice(0,10),
    time: now.toLocaleTimeString()
  });

  document.getElementById("url").value = "";
  document.getElementById("genre").value = "";
  document.getElementById("memo").value = "";

  render(data);
}

function render(list) {
  const div = document.getElementById("list");
  div.innerHTML = "";
  list.forEach((e, i) => {
    div.innerHTML += `
      <div class="entry">
        <div><a href="${e.url}" target="_blank">${e.url}</a></div>
        <div>ジャンル：${e.genre}</div>
        <div>メモ：${e.memo}</div>
        <div class="small">${e.date} ${e.time}</div>
        <button onclick="removeEntry(${i})">削除</button>
      </div>
    `;
  });
}

function removeEntry(i) {
  data.splice(i, 1);
  render(data);
}

function search() {
  const g = document.getElementById("searchGenre").value;
  const d = document.getElementById("searchDate").value;

  const filtered = data.filter(e =>
    (!g || e.genre.includes(g)) &&
    (!d || e.date === d)
  );

  render(filtered);
}

function clearSearch() {
  document.getElementById("searchGenre").value = "";
  document.getElementById("searchDate").value = "";
  render(data);
}
</script>
<button onclick="login()">Googleでログイン</button>
<p id="user"></p>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

<script>
const firebaseConfig = {
  // ここにFirebaseの設定を貼る
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

function login() {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider);
}

auth.onAuthStateChanged(user => {
  if (user) {
    document.getElementById("user").innerText =
      "ログイン中：" + user.displayName;
  }
});
</script>

</body>
</html>
